generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlserver"
  url      = env("DATABASE_URL")
}

model detalle_pedido_ec {
  id          Int      @id(map: "PK__detalle___3213E83F5103D370") @default(autoincrement())
  id_pedido   Int
  id_producto String   @db.VarChar(20)
  cantidad    Int
  precio      Decimal  @db.Decimal(10, 2)
  subtotal    Decimal? @db.Decimal(21, 2)
}

model facturacion_ec {
  id             Int          @id(map: "PK__facturac__3213E83FAAEE544A") @default(autoincrement())
  id_pedido      Int
  total          Decimal      @db.Decimal(10, 2)
  fecha          DateTime?    @default(now(), map: "DF__facturaci__fecha__38996AB5") @db.DateTime
  estado         String       @db.VarChar(20)
  transaction_id String?      @db.VarChar(50)
  pedidos_ec     pedidos_ec[]
}

model pedidos_ec {
  id                 Int                @id(map: "PK_pedidos_ec") @default(autoincrement())
  id_usuario         Int
  fecha              DateTime?          @default(now(), map: "DF__pedidos_e__fecha__33D4B598") @db.DateTime
  estado             String             @db.VarChar(20)
  id_factura         Int?
  monto              Decimal?           @default(0, map: "DF__pedidos_e__monto__09A971A2") @db.Decimal(10, 2)
  email_status       String?            @default("Sin notificar", map: "DF__pedidos_e__email__0A9D95DB") @db.VarChar(50)
  productos          String?            @db.NVarChar(Max)
  usuarios_ecommerce usuarios_ecommerce @relation(fields: [id_usuario], references: [id], onUpdate: NoAction, map: "FK__pedidos_e__id_us__35BCFE0A")
  facturacion_ec     facturacion_ec?    @relation(fields: [id_factura], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "FK_Pedidos_Facturacion")
}

model usuarios_ecommerce {
  id                   Int                    @id(map: "PK__usuarios__3213E83FF7548599") @default(autoincrement())
  codigo_empleado      String                 @unique(map: "UQ__usuarios__CDEF1DDFE0F1A019") @db.VarChar(10)
  nombre               String                 @db.VarChar(100)
  correo               String                 @unique(map: "UQ__usuarios__2A586E0BB5417B56") @db.VarChar(100)
  telefono             String?                @db.VarChar(20)
  direccion            String?                @db.VarChar(255)
  fecha_registro       DateTime?              @default(now(), map: "DF__usuarios___fecha__267ABA7A") @db.DateTime
  estado               String?                @default("Activo", map: "DF__usuarios___estad__276EDEB3") @db.VarChar(20)
  cedula               String                 @db.VarChar(20)
  notificaciones_push  Boolean?               @default(true, map: "DF__usuarios___notif__5629CD9C")
  notificaciones_email Boolean?               @default(true, map: "DF__usuarios___notif__571DF1D5")
  rol                  String                 @default("comprador", map: "DF__usuarios_ec__rol__5AEE82B9") @db.VarChar(20)
  carrito_ec           carrito_ec[]
  historial_compras_ec historial_compras_ec[]
  pedidos_ec           pedidos_ec[]
}

model productos_ec {
  Id                  Int                   @id(map: "PK_productos_ec")
  CodArticulo         Int
  NomArticulo         String                @db.VarChar(255)
  Precio              Int
  categorias          String                @db.VarChar(100)
  image_url           String                @db.VarChar(255)
  carrito_ec          carrito_ec[]
  productos_comprados productos_comprados[]
}

model carrito_ec {
  id                 Int                @id(map: "PK__carrito___3213E83FD6BCBB7A") @default(autoincrement())
  id_usuario         Int
  id_producto        Int
  cantidad           Int
  fecha_agregado     DateTime?          @default(now(), map: "DF__carrito_e__fecha__44FF419A") @db.DateTime
  usuarios_ecommerce usuarios_ecommerce @relation(fields: [id_usuario], references: [id], onUpdate: NoAction, map: "FK__carrito_e__id_us__45F365D3")
  productos_ec       productos_ec       @relation(fields: [id_producto], references: [Id], onUpdate: NoAction, map: "FK_carrito_ec_productos_ec")
}

model historial_compras_ec {
  id                  Int                   @id @default(autoincrement())
  id_usuario          Int
  transaction_id      String                @unique @default("newid()") @db.VarChar(50)
  invoice             String                @db.NVarChar(255)
  fecha_hora          DateTime?             @default(now()) @db.DateTime
  device              String?               @db.NVarChar(255)
  location            String?               @db.NVarChar(255)
  total               Decimal               @db.Decimal(10, 2)
  estado              String                @db.VarChar(50)
  metodo_pago         String                @default("Deducci√≥n de Planilla") @db.NVarChar(100)
  factura_url         String?               @db.NVarChar(255)
  usuarios_ecommerce  usuarios_ecommerce    @relation(fields: [id_usuario], references: [id], onUpdate: NoAction, map: "FK__historial__id_us__4F7CD00D")
  productos_comprados productos_comprados[]
}

model productos_comprados {
  id                   Int                  @id(map: "PK__producto__3213E83F51185642") @default(autoincrement())
  id_historial         Int
  id_producto          Int
  cantidad             Int                  @default(1, map: "DF__productos__canti__534D60F1")
  historial_compras_ec historial_compras_ec @relation(fields: [id_historial], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "FK__productos__id_hi__5441852A")
  productos_ec         productos_ec         @relation(fields: [id_producto], references: [Id], onDelete: Cascade, onUpdate: NoAction, map: "FK_productos_comprados_productos_ec")
}

model sysdiagrams {
  name         String @db.NVarChar(128)
  principal_id Int
  diagram_id   Int    @id(map: "PK__sysdiagr__C2B05B61BFE3378F") @default(autoincrement())
  version      Int?
  definition   Bytes?

  @@unique([principal_id, name], map: "UK_principal_name")
}

model validacion_empleados {
  Codigo_del_empleado String @id(map: "PK_validacion_empleados") @unique(map: "UQ__validaci__3DD7451DBA9EFCAE") @db.VarChar(25)
  Nombre              String @db.VarChar(100)
  NIF                 String @unique(map: "UQ__validaci__C7DEC330756CA4EF") @db.VarChar(20)
}
